The function is implemented in my opinion correctly, but there were problems with accessing the gif api.
From their side came a ban on embedding gifs on third-party sites.
There was an error in the browser: Refused to display 'https://giphy.com/' in a frame because it set 'X-Frame-Options' to 'deny'.